<!DOCTYPE html>
<html lang="">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title></title>
	<link rel="stylesheet" href="">
</head>




<style>
	table {
		text-align: center;
		background-color: coral;
		width: 25%;
		margin: auto;
		border: 2px #0beed0 dashed;
	}

	td {
		padding: 15px;
	}
</style>




<script>
	var edad;

	function comenzar() {

		edad = document.getElementById("miedad")

		edad.addEventListener("change", cambia_rango, false);

		document.datos_usuario.addEventListener("invalid", validar, true);

		document.getElementById("Enviar").addEventListener("click", enviar, false);
		
		document.datos_usuario.addEventListener("input", validar_tiempo_real, false);
	}

	function cambia_rango() {
		var salida = document.getElementById("rango");

		var calculo = edad.value - 30;

		if (calculo < 30) {
			calculo = 0;

			edad.value = 30;
		}

		salida.innerHTML = calculo + " a " + edad.value;
	}


	function validar(e) {

//		for (x in e) {
//			console.log(x);
//		}
//		console.log(e.type);
		var elemento = e.target;
//		console.log(elemento);
//		console.log(elemento.id);
		elemento.style.background = "#fe4c4c";

	}


	function enviar() {
		
		var cuadro_usuario = document.getElementById("usuario");
		var correcto = document.datos_usuario.checkValidity();

		if (correcto == true) {
			document.datos_usuario.submit();
		}else if(cuadro_usuario.validity.valueMissing==true || cuadro_usuario.validity.patternMismatch==true){
			alert("El usuario no puede estar vacio y recuerda que tiene que 3 tener letras");
			
		}
	}
	
	
	
	function validar_tiempo_real(e){
		
		var elemento = e.target;
		
		if (elemento.validity.valid == true) {
			elemento.style.background = "#ffffff";
		}
		else{
			elemento.style.background = "#c21e1e";
		}
	}


	window.addEventListener("load", comenzar, false);
</script>





<body>
	<section>
		<form name="datos_usuario" method="get">
			<table>
				<tr>
					<td>Usuario:</td>
					<td><input pattern="[A-Za-z]{3}" name="usuario" id="usuario" maxlength="10" required></td>
				</tr>

				<tr>
					<td>Email:</td>
					<td><input type="email" name="miemail" id="miemail" required></td>
				</tr>

				<tr>
					<td>Edad:</td>
					<td><input type="range" name="miedad" id="miedad" min="0" max="120" value="30" step="30"></td>
				</tr>

				<tr>
					<td>outpu:</td>
					<td><output id="rango">0 a 30</output></td>
				</tr>


				<tr>
					<td><input type="submit" id="Enviar" value="Registrar"></td>
				</tr>


			</table>

		</form>
	</section>
</body></html>
